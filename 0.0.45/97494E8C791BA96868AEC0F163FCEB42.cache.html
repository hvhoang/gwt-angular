<div data-ng-controller="com.asayama.gwt.angular.examples.client.controller.PromiseExampleController">
  <p>
    GWT Angular supports promise pattern via Java wrapper around AngularJS's
    promise framework, which is inspired by <a href="https://github.com/kriskowal/q">
    Kris Kowal's Q</a>.
  </p><p>
    The below example demonstrates how two asynchronous calls are coordinated
    by a third, which depends on the outcome of the first two. Promise pattern
    makes it easy to establish pipelines of asynchronous calls without having to
    write a complex sequence of nested callbacks.
  </p><p>
    When you click the "Go" button below, first, the user is warned that he must
    wait for 1 second to see the outcome of his action. The user's action kicks
    off two asynchronous calls, one generates the salutation, "Hello", and the
    other generates the name, "World". These two asynchronous calls take 
    different amount of time to complete. There is a third call, which takes the
    results of salutation and name, and formats a greeting. The greeting message
    is then displayed to the screen.
  </p>
  
  <div class="panel panel-primary">
    <div class="panel-body" data-ng-include="DEMO_URL"></div>
  </div>
  
  <h2>View</h2>
  <p>
    The view code is straight forward, and has no knowledge of controller's 
    implementation and its asynchronous nature. It assumes that the greeting
    data is or will be provided, hence it calls <code>{{ getGreeting }}</code>
    method on the controller to obtain the value to print to the screen.
  </p>
  <pre data-gwt-prettify="VIEW_CODE"></pre>

  <h2>Controller</h2>
  <p>
    Controller takes no action load, but when the user clicks the "Go" button,
    it invokes <code>onClickGo()</code> method. This method is responsible for
    communicating with the user by first showing the feedback, "Please wait 1 
    second..." while it makes an asynchronous call to get the greeting data.
    The <code>Done</code> callback consumes the greeting data when it is 
    available, by refreshing the greeting value to the displayed to the screen.
  </p><p>
    <code>promiseGreetin()</code> method returns a promise of greeting, meaning
    that it promises that a String will be eventually returned signifying the
    value of greeting. It depends on two other promises. One is the promise of
    salutation, and the other is the promise of name. When the salutation and
    name values are both available, it combines and formats the two values into
    a single greeting object, and returns to the caller. We use <code>q.all()</code>
    method here because we want to execute the other two asynchronous calls in
    parallel. There is no need to wait for one to complete before start the 
    other.
  </p><p>
    <code>promiseName()</code> method simulates an asynchronous call by using a
    <code>Timer</code> class in GWT. Normally, we would be obtaining the data
    from a remote source via XHR. Nevertheless, this simulated asynchronous call
    returns the value "World" upon its completion, which happens in 500ms.
  </p><p>
    In contrast, <code>promiseSalutation()</code> method returns its value,
    "Hello" in 1 second.
  </p><p>
    When the slower of the two promises is completed, (in this example, the
    salutation call), the <code>q.all()</code> method is evaluated. Because 
    the calls are not nested, it takes 1 second for this to work, not 1.5 
    seconds. Also, besides the runtime efficiency of this model, you may have
    noticed how easily you can abstract each promise into its own block of
    execution. Once you define exactly how each promise is constructed, the
    other promises depending on them do not need to know exactly how the others
    are implemented. If the definition of one of the promises undergoes a change
    it can be done in one place.
  </p>
  <pre data-gwt-prettify="CONTROLLER_CODE"></pre>

  <h2>Configuration</h2>
  <p>
    The following modules are required in the gwt.xml.
  </p>
  <pre>
&lt;inherits name="com.asayama.gwt.angular.NG" /&gt;</pre>

  <p>
    The following Maven dependencies are required in the pom.xml.
  </p>
  <pre>
&lt;dependency&gt;
  &lt;groupId&gt;com.asayama.gwt&lt;/groupId&gt;
  &lt;artifactId&gt;gwt-angular-core&lt;/artifactId&gt;
  &lt;version&gt;{{ PROJECT_VERSION }}&lt;/version&gt;
&lt;/dependency&gt;</pre>

</div>
